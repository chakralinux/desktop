pkgname=opal
pkgver=3.14.4
pkgrel=1
pkgdesc="Open Phone Abstraction Library"
arch=('x86_64')
url="http://www.opalvoip.org/"
license=('MPL')
depends=('gsm' 'libtheora' 'ptlib=2.14.4' 'silc-toolkit' 'speex' 'x264')
makedepends=('ffmpeg')
source=(http://downloads.sourceforge.net/opalvoip/$pkgname-$pkgver.tar.bz2)
sha512sums=('589f6c8eb236ae41faec199fa807a7c1c5ab32adbf7914f8c14597d797b7dd62d5d1ee40a25c5e8920b276cef0926915784c7bd2ce5b8ef38d7e84833c64cb54')

build() {
  cd $srcdir/$pkgname-$pkgver

  export PKG_CONFIG_PATH=/usr/lib/pkgconfig
  export LD_LIBRARY_PATH=/usr/lib
  export PTLIBPLUGINDIR=/usr/lib/ptlib-3.14:/usr/lib/opal-3.14

  CXXFLAGS="$CXXFLAGS -fpermissive" \
  ./configure \
    --localstatedir=/var \
    --prefix=/usr \
    --sysconfdir=/etc
  make
}

package() {
  cd $srcdir/$pkgname-$pkgver
  make DESTDIR=$pkgdir install
  chmod 644 "${pkgdir}/usr/lib/libopal_s.a"
}
