# Maintainer: UtG  <utg[dot]chakra.linux[at]gmail[dot]com>
 
pkgname=qt4-fsarchiver
pkgver=0.6.19.9
_pkgver=0.6.19-9
pkgrel=1
pkgdesc='GUI for fsarchiver'
arch=('x86_64')
url='http://sourceforge.net/projects/qt4-fsarchiver/'
license=('GPL')
depends=('fsarchiver' 'kde-runtime')
makedepends=('qt')
categories=('utils')
screenshot=('http://media.cdn.ubuntu-de.org/wiki/attachments/02/04/verzeichnis.jpg')
source=("http://sourceforge.net/projects/${pkgname}/files/source/${pkgname}-${_pkgver}.tar.gz")
install="${pkgname}.install"
sha1sums=('434cc08cdf91d0820f025e3e46a16489f312e915')

build() {
	cd "${srcdir}/${pkgname}"
	qmake
}

package() {
  cd "${srcdir}/${pkgname}"
  make
  make INSTALL_ROOT="${pkgdir}" install
  
  mkdir -p ${pkgdir}/usr/share/qt/translations
  rm -R ${pkgdir}/usr/share/qt4
  install -D -m644 ${srcdir}/${pkgname}/translations/*.qm ${pkgdir}/usr/share/qt/translations
	
  # workaround for fixed destination path in qmake project
  mkdir -p ${pkgdir}/usr/bin
  mv ${pkgdir}/usr/sbin/qt4-fsarchiver ${pkgdir}/usr/bin/
  rm -rf ${pkgdir}/usr/sbin
  
  sed s/Terminal=true/Terminal=false/ -i ${pkgdir}/usr/share/applications/qt4-fsarchiver.desktop
  sed s/sudo/kdesu/ -i ${pkgdir}/usr/share/applications/qt4-fsarchiver.desktop
	
}
