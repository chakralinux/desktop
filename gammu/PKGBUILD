pkgname=gammu
pkgver=1.36.3
pkgrel=1
pkgdesc="GNU All Mobile Management Utilities"
arch=('x86_64')
url="http://wammu.eu/"
license=('GPL')
depends=('bluez' 'curl' 'libmysqlclient'
         'postgresql-libs' 'python2' 'libusb' 'gnutls')
makedepends=('cmake' 'doxygen' 'mysql')
optdepends=('dialog: support for the gammu-config script')
categories=('utils')
source=(http://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.bz2)
sha512sums=('f814ff1fd68f2d46681548f0fc2f955888cd215ac898c2dbe269c4ff6e57bfeb9b80d8ef105c2fed092eb3877b43cfa5e8d02d7c630029ac4798d83c840988ba')

build() {
  cd "$srcdir/$pkgname-$pkgver"

  # bash completion dir change
  sed -i 's,DESTINATION "/etc/bash_completion.d",DESTINATION "/usr/share/bash-completion/completions",' contrib/CMakeLists.txt
  cmake . -DCMAKE_INSTALL_PREFIX="/usr"

  make
}

package() {
  cd "$srcdir/$pkgname-$pkgver"

  make DESTDIR="$pkgdir" install
  mv $pkgdir/usr/lib64/* $pkgdir/usr/lib
  rm -d $pkgdir/usr/lib64
}
