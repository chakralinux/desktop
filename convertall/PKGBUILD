pkgname=convertall
pkgver=0.7.2
pkgrel=1
pkgdesc="Unit conversion program (Qt)"
arch=('x86_64')
url="http://convertall.bellz.org/"
license=('GPL')
depends=('python3-pyqt5')
categories=('utils')
source=(http://downloads.sourceforge.net/sourceforge/$pkgname/$pkgver/$pkgname-$pkgver.tar.gz
        "correctpaths.patch"
        "convertall.desktop")
sha256sums=('9d465d12fbb45f88359b1d80619658143b203014157f65843917c1f63337c8a4'
            '366ea0e23197b469402c2b3d6cdf4a77388813b91254d1ce3603e6cd0787fc3b'
            '939c566d8015b6b0ab8dc82ba5161643c25c8619bd81b7d165c03eda33669ccb')

package() {
# patch executable to have the correct paths
patch -Np0 < $srcdir/correctpaths.patch

# create install directories
  install -d $pkgdir/usr/{bin,share/pixmaps}

# copy files manually
cp -rf $srcdir/ConvertAll/source $pkgdir/usr/share/$pkgname
cp -rf $srcdir/ConvertAll/icons $pkgdir/usr/share/$pkgname
cp -rf $srcdir/ConvertAll/doc $pkgdir/usr/share/$pkgname/help
cp -rf $srcdir/ConvertAll/data $pkgdir/usr/share/$pkgname

# create symlink in /usr/bin
ln -s /usr/share/$pkgname/$pkgname.py $pkgdir/usr/bin/$pkgname

# install desktop file
install -Dm644 $srcdir/$pkgname.desktop \
	$pkgdir/usr/share/applications/$pkgname.desktop

# symlink icon in /usr/share/pixmaps
ln -s /usr/share/$pkgname/icons/$pkgname.svg \
	$pkgdir/usr/share/pixmaps/$pkgname.svg
}
