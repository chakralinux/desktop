# Maintainer: Fabian Kosmale <0inkane@googlemail.com>
# Contributor: arlx_ignacy <ziphims@gmail.com>
# Contributor: Douglas Soares de Andrade <douglas@archlinux.org>

pkgname=python3-pyside
_pkgname=pyside
_qtver=4.8
pkgver=1.2.2
pkgrel=3
pkgdesc='CPython Qt bindings generated using the Shiboken generator. (Python 3 build)'
arch=('i686' 'x86_64')
license=('LGPL')
url='http://www.pyside.org'
depends=('python3-shiboken>=1.2.0' 'python3' "qt>=${_qtver}" 'phonon' 'mesa')
makedepends=('cmake' 'automoc4' 'graphviz')
replaces=('pyside-py3')
source=("http://download.qt-project.org/official_releases/pyside/${_pkgname}-qt${_qtver}+$pkgver.tar.bz2"
        'cmake_fixes.patch')
md5sums=('981c7d0b3b6aa4057563a46454f7f9ec'
         '28fdf3a61c1ae4b47c5f6f762e428956')

prepare() {

   cd $srcdir/${_pkgname}-qt${_qtver}+$pkgver
   patch -p1 -N < ../cmake_fixes.patch
    [[ -d build ]] || mkdir -p build
}

build(){
    cd $srcdir/${_pkgname}-qt${_qtver}+$pkgver/build
    cmake .. -DCMAKE_INSTALL_PREFIX=/usr \
             -DCMAKE_BUILD_TYPE=Release  \
             -DBUILD_TESTS=OFF
#             -Dpyside_SUFFIX=-python3
    make
}


package() {
    cd $srcdir/${_pkgname}-qt${_qtver}+$pkgver/build
    make DESTDIR=$pkgdir install
}
md5sums=('1969c2ff90eefaa4b200d234059d2287'
         '28fdf3a61c1ae4b47c5f6f762e428956')
