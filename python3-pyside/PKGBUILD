# Maintainer: Fabian Kosmale <0inkane@googlemail.com>
# Contributor: arlx_ignacy <ziphims@gmail.com>
# Contributor: Douglas Soares de Andrade <douglas@archlinux.org>

pkgname=python3-pyside
_pkgname=pyside-pyside
pkgver=1.2.2
pkgrel=2
pkgdesc='CPython Qt bindings generated using the Shiboken generator. (Python 3 build)'
arch=('i686' 'x86_64')
license=('LGPL')
url='http://www.pyside.org'
depends=('python3-shiboken>=1.2.0' 'python3' 'qt>=4.8' 'phonon' 'mesa')
makedepends=('cmake' 'automoc4' 'graphviz')
replaces=('pyside-py3')
source=("${_pkgname}-${pkgver}.tar.gz::https://qt.gitorious.org/pyside/pyside/archive/${pkgver}.tar.gz"
        'cmake_fixes.patch')
md5sums=('2407ab75a0287d3c951cd82534475af7'
         '28fdf3a61c1ae4b47c5f6f762e428956')

prepare() {
   cd $srcdir/${_pkgname}
   patch -p1 -N < ../cmake_fixes.patch
    [[ -d build ]] || mkdir -p build
}

build(){
    cd $srcdir/${_pkgname}/build
    cmake .. -DCMAKE_INSTALL_PREFIX=/usr \
             -DCMAKE_BUILD_TYPE=Release  \
             -DBUILD_TESTS=OFF
#             -Dpyside_SUFFIX=-python3
    make
}


package() {
    cd $srcdir/${_pkgname}/build
    make DESTDIR=$pkgdir install
}
