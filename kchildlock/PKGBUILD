#
# Apps Packages for Chakra, part of chakra-project.org
#
# Maintainer: Adrián Chaves Fernández (Gallaecio) <adriyetichaves gmail.com>

# include global config
source ../_buildscripts/${current_repo}-${_arch}-cfg.conf

pkgname=kchildlock
pkgver=0.90.1
pkgrel=1
pkgdesc="Computer usage time monitor and administrator, focused on parental control."
url="http://sourceforge.net/projects/kchildlock"
license=('GPL2')
arch=('i686' 'x86_64')
depends=('kdebase-runtime')
makedepends=('automoc4' 'cmake' 'docbook-xsl')
source=(http://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.gz
	docbook-version-fix.diff)
md5sums=('ca3883bb69d50653426346a7c07d9645'
         '68fe7edb62e9f56cd6b00dfa539122b4')

build() {
#   find . -name CMakeLists.txt -exec sed -i 's/add_subdirectory(doc)/#add_subdirectory(doc)/g' {} \;

  # Documentation patch.
  cd $srcdir/$pkgname-$pkgver/doc/en/
  patch -uN index.docbook $srcdir/docbook-version-fix.diff

  cd $srcdir/$pkgname-$pkgver  
  mkdir build && cd build
  cmake \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_BUILD_TYPE=RelWithDebInfo \
    ..
  make
#   cmake
#     -DCMAKE_INSTALL_PREFIX=/usr
#     -G KDevelop3
#     -DCMAKE_BUILD_TYPE=Release \
#     -DDATA_INSTALL_DIR=/usr/share/kde4/
#     -DICON_INSTALL_DIR=/usr/share/kde4 .
#   make
}

package() {
  cd ${srcdir}/$pkgname-$pkgver/build
  make DESTDIR=${pkgdir} install
}
