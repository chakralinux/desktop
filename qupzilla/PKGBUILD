# Contributor: Neophytos Kolokotronis <tetris4@gmail.com>

pkgname=qupzilla
pkgver=1.1.8
pkgrel=2
commit=g${_commit}
_commit=6878522
pkgdesc="A very fast open source browser based on WebKit core"
url="http://www.qupzilla.com"
arch=('i686' 'x86_64')
license=('GPL3')
depends=('qt')
source=("https://www.github.com/nowrep/QupZilla/tarball/master/nowrep-QupZilla-${commit}.tar.gz"
        'searchenginesmanager.diff'
        'speeddial.diff'
        'preferences.diff'
        'qupzilla.diff'
        'start-white.png')
md5sums=('db8cf7c487435e8e7e552b6f3bff1a76'
         'c2e9cc0b063130425df6b48c8d78540a'
         'a7502451930dd0b3e1bf1e297b69f605'
         '945f9530f75f4c5e6097459d7f2ee918'
         '8e495fa90d5043fb4d0d6e1cac097290'
         'fc705d7aba952361a626a2c79726bbfa')

build() {
   cd "${srcdir}/nowrep-QupZilla-${_commit}/"
   patch -Np0 -i "${srcdir}/searchenginesmanager.diff"
   patch -Np0 -i "${srcdir}/speeddial.diff"
   patch -Np0 -i "${srcdir}/preferences.diff"
   patch -Np0 -i "${srcdir}/qupzilla.diff"
   export USE_WEBGL="true"
   export KDE="true"
   qmake QupZilla.pro
   make
}

package() {
   cd "${srcdir}/nowrep-QupZilla-${_commit}/"
   mkdir -p ${pkgdir}/usr/share/icons
   install -m 644 -p ${srcdir}/start-white.png ${pkgdir}/usr/share/icons/
   make INSTALL_ROOT=$pkgdir install
}