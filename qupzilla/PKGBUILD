# Contributor: Neophytos Kolokotronis <tetris4@gmail.com>
# Contributor: Fabian Kosmale <0inkane@googlemail.com>

pkgname=qupzilla
pkgver=1.3.5
pkgrel=1
_commit=e59241f  
pkgdesc="A very fast open source browser based on WebKit core"
url="http://www.qupzilla.com"
arch=('i686' 'x86_64')
license=('GPL3')
depends=('qt')
categories=('network') 
source=("https://github.com/QupZilla/QupZilla/tarball/master/QupZilla-qupzilla-${pkgver}.tar.gz"
        'searchenginesmanager.diff'
        'speeddial.diff'
        'preferences.diff'
        'qupzilla.diff'
        'start-white.png')
md5sums=('31843d47ab680a41503275495d874427'
         '7e1b3743fba94b54ab0858e7588cca83'
         'b58d03f2e52ea3391e63c0eeea3e82a4'
         'ac98b9f9cc45df18070eabee518c0049'
         'fc0aa2bef51e5488f129b4618ee18545'
         'fc705d7aba952361a626a2c79726bbfa')

build() {
   cd "${srcdir}/QupZilla-qupzilla-${_commit}/"
   patch -p0 -i "${srcdir}/searchenginesmanager.diff"
   patch -p0 -i "${srcdir}/speeddial.diff"
   patch -p0 -i "${srcdir}/preferences.diff"
   patch -p0 -i "${srcdir}/qupzilla.diff"
   export USE_WEBGL="true"
   export KDE="true"
   qmake QupZilla.pro
   make
}

package() {
   cd "${srcdir}/QupZilla-qupzilla-${_commit}/"
   mkdir -p ${pkgdir}/usr/share/icons
   install -m 644 -p ${srcdir}/start-white.png ${pkgdir}/usr/share/icons/
   make INSTALL_ROOT=$pkgdir install
}
