# Maintainer: Anke Boersma <abveritas@chakra-project.org>

pkgname=qupzilla
pkgver=1.4.3
pkgrel=1
#_commit=812437d
pkgdesc="A very fast open source browser based on WebKit core"
url="http://www.qupzilla.com"
arch=('x86_64')
license=('GPL3')
depends=('qtwebkit' 'qtwebkit-plugins')
categories=('network') 
source=("https://github.com/QupZilla/qupzilla/archive/v1.4.2.tar.gz"
        #https://github.com/QupZilla/QupZilla/tarball/master/QupZilla-qupzilla-${pkgver}.tar.gz"
        #"https://github.com/downloads/QupZilla/qupzilla/QupZilla-${pkgver}.tar.gz"
        'searchenginesmanager.diff'
        'speeddial.diff'
        'preferences.diff'
        'qupzilla.diff'
        'start-white.png')
md5sums=('aadeca644a22c2df0da3e6172f327434'
         'c5c0f9e3640d0f5695034aef63648967'
         '7dc447b9ef93186c8fa3b8f1f0ce806e'
         'b028e33ad46bf9c74cfb759f480f170a'
         'd2b0897549cbaac6147c33e05ace8481'
         'fc705d7aba952361a626a2c79726bbfa')

build() {
   cd "${srcdir}/${pkgname}-${pkgver}/"
   patch -p0 -i "${srcdir}/searchenginesmanager.diff"
   patch -p0 -i "${srcdir}/speeddial.diff"
   patch -p0 -i "${srcdir}/preferences.diff"
   patch -p0 -i "${srcdir}/qupzilla.diff"
   #patch -p0 -i "${srcdir}/fix_back_next-popup.patch"
   export USE_WEBGL="true"
   export KDE="true"
   qmake QupZilla.pro
   make
}

package() {
   cd "${srcdir}/${pkgname}-${pkgver}/"
   mkdir -p ${pkgdir}/usr/share/icons
   install -m 644 -p ${srcdir}/start-white.png ${pkgdir}/usr/share/icons/
   make INSTALL_ROOT=$pkgdir install
}
