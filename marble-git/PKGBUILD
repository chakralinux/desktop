pkgname=marble-git
pkgver=9884.185c718
pkgrel=1
pkgdesc="Virtual Globe and World Atlas"
arch=('i686' 'x86_64')
url="http://marble.kde.org/"
license=('LGPL 2.1')
depends=('qt5-base' 'qt5-declarative' 'qt5-script' 'qt5-webkit')
makedepends=('automoc4' 'cmake' 'git' 'qt5-tools')
optdepends=("gpsd: GPS daemon and library to support USB/serial GPS devices")
install=marble.install
conflicts=('kdeedu-marble' 'marble')
source=('git+git://anongit.kde.org/marble')
md5sums=('SKIP')

prepare() {
   cd $srcdir/marble
   cmake ../marble  -DCMAKE_BUILD_TYPE=RelWithDebInfo -DQT5BUILD=ON -DCMAKE_INSTALL_PREFIX=/usr
}

build() {
   cd $srcdir/marble
   make
}

package() {   
   cd $srcdir/marble
   make DESTDIR=$pkgdir install
}

pkgver() {
  cd $srcdir/marble
  echo $(git rev-list --count master).$(git rev-parse --short master)
}
