#
# Chakra Packages for Chakra, part of chakra-project.org
#
# maintainer (i686): Phil Miller <philm[at]chakra-project[dog]org>
# maintainer (x86_64): Manuel Tortosa <manutortosa[at]chakra-project[dot]org>

# include global config
source ../_buildscripts/${current_repo}-${_arch}-cfg.conf

#
# package info
#
pkgname=kde-wallpapers
pkgver=${_kdever}
pkgrel=1

_default_wp="Ariya"

pkgbase="kde-wallpapers"
pkgname=("kde-wallpapers"
	 "kde-wallpapers-crunchy-branch-blue"
	 "kde-wallpapers-ashoc"
	 "kde-wallpapers-neda"
	 "kde-wallpapers-ronak"
	 "kde-wallpapers-ronak-light")

pkgdesc="KDE Wallpapers for Chakra"
url="http://www.chakra-project.org"
license="GPL"
arch=('any')
options=('!splithdr' 'splitdbg')
groups=("kde" "kde-uninstall")

source=("$_mirror/${pkgbase}-$_kdever.tar.xz"
	"http://chakra.sourceforge.net/sources/kde-wallpapers/kde-wallpapers-crunchy-branch-blue-1.0.tar.gz"
	"http://chakra.sourceforge.net/sources/kde-wallpapers/kde-wallpapers-ashoc-1.0-2.tar.gz"
	"http://chakra.sourceforge.net/sources/neda/NEDA.tar.gz"
	"http://chakra.sourceforge.net/sources/ronak/ronak-wallpaper-1.0.tar.gz"
	"http://chakra.sourceforge.net/sources/ronak/ronak-light-wallpaper-1.0.tar.gz")
md5sums=(`grep ${pkgbase}-$_kdever.tar.xz ../kde-sc.md5 | cut -d" " -f1`
	 "52d75a03f18204dde7965bd3dccb9ce4"  #  kde-wallpapers-crunchy-branch-blue-1.0.tar.gz
	 "e6a3a7e170a739d226c180f5c2a09618"  #  kde-wallpapers-ashoc-1.0-2.tar.gz
	 "83686866b1e7313b77b3cf98c5c4ddc3" #  NEDA.tar.gz
	 "0ec4edb6308f647e8eedb4490b846008"
         "ff75399ca35846ee8dab701af975b8ee")

makedepends=('automoc4')

#_gitroot="git://git.chakra-project.org/artwork/kde-wallpapers.git"
#_gitname="kde-wallpapers"

#
# build function
#
build() {

	 # Smart hack here, cool :)

#        cd "${srcdir}"
#        msg "Connecting to GIT server...."
#
#        if [ -d $_gitname ] ; then
#        cd $_gitname && git pull
#        msg "The local files are updated."
#        else
#	      git clone $_gitroot
#        fi
#        msg "GIT checkout done or server timeout"
#        msg "Starting make..."
#
#        rm -rf "${srcdir}/$_gitname-build"
#
#        cp -r "${srcdir}/$_gitname" "${srcdir}/$_gitname-build"

	msg "building official kde wallpapers"
	cd ${srcdir}/${pkgbase}-${pkgver}

	cmake . -DCMAKE_BUILD_TYPE=${_build_type} \
		-DCMAKE_INSTALL_PREFIX=${_installprefix} \
		-DCMAKE_{SHARED,MODULE,EXE}_LINKER_FLAGS='-Wl,--no-undefined -Wl,--as-needed'

	make

}

#
# split-install functions
#

package_kde-wallpapers()
{
	replaces=('kdebase-workspace-wallpapers')
	cd ${srcdir}/${pkgbase}-${pkgver}
	make DESTDIR=${pkgdir} install

	rm -rfv ${pkgdir}/usr/share/wallpapers/${_default_wp}
}

package_kde-wallpapers-crunchy-branch-blue()
{

	pkgdesc="Crunchy-Branch Wallpaper (blue) by Carles Codony"
	groups=("kde" "kde-complete" "kde-uninstall" "kde-minimal" "kde-wallpapers")

	_WALLPAPER="crunchy-branch-blue"

	cd ${srcdir}/$_WALLPAPER
	
	mkdir -pv $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images
	cp -Rv * $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images
	cd $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images

#	#fix structure
#	_FILES="*.jpg"
#	for i in $_FILES
#	do
#	#proper rename
#	_OUT=$(echo $i | sed "s/KDEmod-Galaxair-//g" | sed 's/-/x/g')
#	mv -v $i $_OUT
#	done
	cp -v $startdir/metadata.desktop $pkgdir/usr/share/wallpapers/$_WALLPAPER
	cd $pkgdir/usr/share/wallpapers/$_WALLPAPER
	sed -i -e "s~WALLPAPERNAME~$_WALLPAPER~g" metadata.desktop
	sed -i -e "s~AUTHOR~Carles Codony~g" metadata.desktop

}

package_kde-wallpapers-ashoc()
{

	pkgdesc="Ashoc Wallpaper by Taner Candan"
	groups=("kde" "kde-complete" "kde-uninstall" "kde-minimal" "kde-wallpapers")

	_WALLPAPER="ashoc"

	cd ${srcdir}/$_WALLPAPER
	
	mkdir -pv $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images
	cp -Rv * $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images
	cd $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images

#	#fix structure
#	_FILES="*.jpg"
#	for i in $_FILES
#	do
#	#proper rename
#	_OUT=$(echo $i | sed "s/KDEmod-Galaxair-//g" | sed 's/-/x/g')
#	mv -v $i $_OUT
#	done
	cp -v $startdir/metadata.desktop $pkgdir/usr/share/wallpapers/$_WALLPAPER
	cd $pkgdir/usr/share/wallpapers/$_WALLPAPER
	sed -i -e "s~WALLPAPERNAME~$_WALLPAPER~g" metadata.desktop
	sed -i -e "s~AUTHOR~Taner Candan~g" metadata.desktop

}

package_kde-wallpapers-neda()
{

	pkgdesc="Chakra NEDA Theme by Roozbeh Shafiee "
	groups=("kde" "kde-complete" "kde-uninstall" "kde-minimal" "kde-wallpapers")

	_WALLPAPER="NEDA"

	cd ${srcdir}/NEDA/wallpaper/
	
	mkdir -pv $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images
	cp -Rv * $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images
	cd $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images

#	#fix structure
#	_FILES="*.jpg"
#	for i in $_FILES
#	do
#	#proper rename
#	_OUT=$(echo $i | sed "s/KDEmod-Galaxair-//g" | sed 's/-/x/g')
#	mv -v $i $_OUT
#	done
	cp -v $startdir/metadata.desktop $pkgdir/usr/share/wallpapers/$_WALLPAPER
	cd $pkgdir/usr/share/wallpapers/$_WALLPAPER
	sed -i -e "s~WALLPAPERNAME~$_WALLPAPER~g" metadata.desktop
	sed -i -e "s~AUTHOR~Roozbeh Shafiee~g" metadata.desktop

}

package_kde-wallpapers-ronak()
{

	pkgdesc="Chakra Ronak Theme by Roozbeh Shafiee "
	groups=("kde" "kde-complete" "kde-uninstall" "kde-minimal" "kde-wallpapers")

	_WALLPAPER="RONAK"

	cd ${srcdir}/ronak-wallpaper
	
	mkdir -pv $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images
	cp -Rv * $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images
	cd $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images

#	#fix structure
#	_FILES="*.jpg"
#	for i in $_FILES
#	do
#	#proper rename
#	_OUT=$(echo $i | sed "s/KDEmod-Galaxair-//g" | sed 's/-/x/g')
#	mv -v $i $_OUT
#	done
	cp -v $startdir/metadata.desktop $pkgdir/usr/share/wallpapers/$_WALLPAPER
	cd $pkgdir/usr/share/wallpapers/$_WALLPAPER
	sed -i -e "s~WALLPAPERNAME~$_WALLPAPER~g" metadata.desktop
	sed -i -e "s~AUTHOR~Roozbeh Shafiee~g" metadata.desktop

}

package_kde-wallpapers-ronak-light()
{

	pkgdesc="Chakra Ronak Theme by Roozbeh Shafiee "
	groups=("kde" "kde-complete" "kde-uninstall" "kde-minimal" "kde-wallpapers")

	_WALLPAPER="RONAK-LIGHT"

	cd ${srcdir}/ronak-light-wallpaper
	
	mkdir -pv $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images
	cp -Rv * $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images
	cd $pkgdir/usr/share/wallpapers/$_WALLPAPER/contents/images

#	#fix structure
#	_FILES="*.jpg"
#	for i in $_FILES
#	do
#	#proper rename
#	_OUT=$(echo $i | sed "s/KDEmod-Galaxair-//g" | sed 's/-/x/g')
#	mv -v $i $_OUT
#	done
	cp -v $startdir/metadata.desktop $pkgdir/usr/share/wallpapers/$_WALLPAPER
	cd $pkgdir/usr/share/wallpapers/$_WALLPAPER
	sed -i -e "s~WALLPAPERNAME~$_WALLPAPER~g" metadata.desktop
	sed -i -e "s~AUTHOR~Roozbeh Shafiee~g" metadata.desktop

}
