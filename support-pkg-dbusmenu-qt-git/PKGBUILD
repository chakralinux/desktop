#
# KDE SC Packages for Chakra, part of chakra-project.org
#
# maintainer (i686): Phil Miller <philm[at]chakra-project[dog]org>
# maintainer (x86_64): Manuel Tortosa <manutortosa[at]chakra-project[dot]org>

pkgname=dbusmenu-qt-git
pkgver=20101019
pkgrel=2
pkgdesc="A standalone library providing a way to import and export QMenu instances using the DBusMenu protocol."
arch=('i686' 'x86_64')
license=('GPL')
depends=('qt' 'qjson')
makedepends=('git' 'cmake')
url="http://gitorious.org/dbusmenu/"
conflicts=('dbusmenu-qt')
provides=('dbusmenu-qt')
source=(http://chakra-project.org/sources/${pkgname}/${pkgname}-${pkgver}.tar.xz)
md5sums=(a4fa14066609b87935800f7a0d5077f4)

# create tarball: source PKGBUILD && mksource

mksource() {
  git clone git://gitorious.org/dbusmenu/dbusmenu-qt.git
  pushd dbusmenu-qt
  popd
  tar -cvJf ${pkgname}-${pkgver}.tar.xz dbusmenu-qt/*
  md5sum ${pkgname}-${pkgver}.tar.xz
}

build() {
  cd $srcdir
 
  mkdir -p $srcdir/dbusmenu-qt-build
  
  cd $srcdir/dbusmenu-qt-build

  cmake $startdir/src/dbusmenu-qt -DCMAKE_BUILD_TYPE=Release \
                -DCMAKE_INSTALL_PREFIX=/usr 
  make || return 1
  make DESTDIR=$pkgdir install || return 1
  
  rm -rf $srcdir/dbusmenu-qt-build
}
