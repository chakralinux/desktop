# Maintainer: Anke Boersma <abveritas@chakra-project.org>

pkgname=octopi
pkgver=1.3.1
pkgrel=1
_commit=649b1b5
pkgdesc="This is Octopi, a powerful Pacman frontend using Qt libs"
url="https://octopiproject.wordpress.com/"
arch=('x86_64')
license=('GPL3')
depends=('qt' 'pacman')
categories=('system') 
screenshot=('http://octopiproject.files.wordpress.com/2013/03/octopi_013_reinstalling_poppler.png?w=1000&h=')
source=("https://github.com/aarnt/octopi/tarball/master/octopi-${pkgver}.tar.gz"
        'octopi.desktop'
        'help_en_US.diff'
        'main.diff'
        'mainwindow_init.diff'
        'strconstants.diff'
        'unixcommand.diff'
        'unixcommand_h.diff'
        'launch-konsole-for-updates.patch')
md5sums=('8f7518126df9b267cb68aa583923f517'
         '2d9c64cd6402be69d2ee9fde5acc439e'
         '09b4271cb0eee3ecc7f4080d145726d9'
         '4d0a34c238400699864c1cdccdc4916b'
         '98b4dfbd1a80cbed4d078d5e4ec6d03b'
         '2cf50990b29b29ff94b53bc8436ec701'
         'f7d8652690d135f5b1122d3eede1e31a'
         '97dd0784a64a54359183429af1de78db')

build() {
   cd "${srcdir}/aarnt-octopi-${_commit}/"
   patch -p0 -i ${srcdir}/help_en_US.diff
   patch -p0 -i ${srcdir}/main.diff
   patch -p0 -i ${srcdir}/mainwindow_init.diff
   patch -p0 -i ${srcdir}/strconstants.diff
   patch -p0 -i ${srcdir}/unixcommand.diff
   patch -p0 -i ${srcdir}/unixcommand_h.diff
   patch -p1 -i ${srcdir}/launch-konsole-for-updates.patch
   qmake 
   make
}

package() {
   cd "${srcdir}/aarnt-octopi-${_commit}/"
   
   mkdir -p ${pkgdir}/usr/share/icons
   install -m 644 -p resources/images/octopi_yellow.png ${pkgdir}/usr/share/icons/octopi.png
   
   mkdir -p ${pkgdir}/usr/bin
   cp bin/octopi ${pkgdir}/usr/bin
   
   mkdir -p ${pkgdir}/usr/share/applications
   install -m644 -p ${srcdir}/octopi.desktop ${pkgdir}/usr/share/applications
}
