#
# Games Packages for Chakra, part of chakra-project.org
#
# Maintainer: Adrián Chaves Fernández (Gallaecio) <adriyetichaves gmail.com>

# include global config
source ../_buildscripts/${current_repo}-${_arch}-cfg.conf

pkgname=dawn
_pkgname=dawn-rpg
pkgver=0.0.38
pkgrel=1
pkgdesc="2D RPG set in a fantasy world."
arch=('i686' 'x86_64')
license=('GPL3')
url="http://dawn-rpg.sourceforge.net/wiki"
depends=('sdl' 'sdl_image' 'sdl_mixer' 'libgl' 'mesa' 'freeglut' 'freetype2' 'lua' 'toluapp')
makedepends=('autoconf' 'automake')
replaces=('dawn-rpg')
changelog=ChangeLog
source=("http://downloads.sourceforge.net/project/$_pkgname/$_pkgname/$pkgname-$pkgver.tar.gz")
md5sums=('ab07f03f2b8f04b00218f98153f29810')

build() {
  cd $srcdir/$pkgname-$pkgver

# Emptied for this configuration  
  LDFLAGS="" \
  ./configure --prefix=/usr
  make || return 1
}

package() {
  cd $srcdir/$pkgname-$pkgver
#   make DESTDIR=$pkgdir install

  install -Dm 755 $srcdir/$pkgname-$pkgver/$_pkgname $pkgdir/usr/share/$pkgname/$pkgname
  cp -R $srcdir/$pkgname-$pkgver/data $pkgdir/usr/share/$pkgname/data

  # Temporal launcher:
  mkdir -p $pkgdir/usr/bin
  echo "#!/bin/bash"				> $pkgdir/usr/bin/$pkgname
  echo "cd /usr/share/$pkgname"			>> $pkgdir/usr/bin/$pkgname
  echo "./$pkgname"				>> $pkgdir/usr/bin/$pkgname
  chmod +x $pkgdir/usr/bin/$pkgname
}
