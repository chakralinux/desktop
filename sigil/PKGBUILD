# maintainer abveritas@chakra-project.org
# contributor Giuseppe Cal√† <jiveaxe@gmail.com>

pkgname=sigil
_pkgname=Sigil
pkgver=0.8.1
pkgrel=1
pkgdesc="A multi-platform WYSIWYG ebook editor. It is designed to edit books in ePub format. "
arch=('x86_64')
url="http://code.google.com/p/sigil/"
license=('GPL3')
depends=('qt5-webkit' 'boost-libs')
makedepends=('qt5-tools' 'qt5-svg' 'cmake' 'gendesk' 'boost')
categories=('office')
install=sigil.install
screenshot=('http://1.bp.blogspot.com/-K2Q-tdVbPRI/UI08v7LhzHI/AAAAAAAAABY/vZ5LHjM6nb4/s1600/Screen+Shot+2012-10-28+at+10.07.03+AM.png')
source=("https://github.com/user-none/Sigil/releases/download/${pkgver}/${_pkgname}-${pkgver}-Code.zip")
sha1sums=('dfb2812fd5cceed427110ca76146822304437a52')


build() {
  cd "${srcdir}/Sigil-${pkgver}"
  gendesk -n "$startdir"/PKGBUILD

  mkdir -p build 
  cd build

  cmake -G "Unix Makefiles" \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_C_FLAGS:STRING="$CFLAGS" \
    -DCMAKE_CXX_FLAGS:STRING="$CXXFLAGS" \
    -DCMAKE_BUILD_TYPE=Release \
    -DCMAKE_SKIP_RPATH=ON ..
  make
}

package() {
  cd "${srcdir}/Sigil-${pkgver}/build"
  make DESTDIR=$pkgdir install
  install -d -m 0755 "${pkgdir}"/usr/share/applications

  # Desktop integration.
  install -Dm0644 $srcdir/${_pkgname}-${pkgver}/$pkgname.desktop $pkgdir/usr/share/applications/$pkgname.desktop
  for _pic in 16 32 48 128 256; do
    install -Dm0644 ../src/Sigil/Resource_Files/icon/app_icon_$_pic.png \
      $pkgdir/usr/share/icons/hicolor/$_picx$_pic/apps/$pkgname.png
  done
   install -Dm644 ../src/Sigil/Resource_Files/icon/app_icon_128.png \
       "$pkgdir/usr/share/pixmaps/$pkgname.png"
}
