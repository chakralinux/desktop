pkgbase="libreoffice-i18n"

_rcver=6.2.0.3
pkgver=6.2.0
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dsb           "Lower Sorbian"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('9252731cc80de1783c5eb83b6bbf84cc'
         '37bd8b17d7e42fe82892c2d6c2bf29da'
         '707f6c8373a804b7dd11b1e4feefff90'
         '1de259c6132f9513acd201cb1b2c63bc'
         '6839b98d8ee6b2eacb911d6744d50348'
         '1569fe95fef7324b632ca94862e01eee'
         '3a4c911ee1be93184eb2d7ebc5ba116a'
         '922eba7781707f59129d88b7f7dfc661'
         'eec10c28f9a8545fdd9b76499c7f5d93'
         '06688b6cfe75f75a1ddc474585a6ebf7'
         '907147963de36d3b857932de5862c6bb'
         'fb258d67e702d388f374785526a1c068'
         '98365413117c24b20611333a61d34784'
         'd02f4e6babf761a7652304ff54f84fb4'
         '21a62936ebf9a94cda839b76a5a93eb2'
         '46e8a6d1d45214d3041d370d44345cdc'
         '8a593c98c9687f4cae0a6e2e65de4d12'
         '1ebef13ab06cd77013f2508f136a816c'
         '80f7c2626ce092afd5bc4be55eb2026e'
         'c3e8f05c51316750ea85bb29434f2f71'
         '437b620493685f960bccbd5b9eebce58'
         'cb4a52aefedde0c1d968f5ea0a99c119'
         'e114df40aa765ce09677b95907d484d5'
         '3f1abfb767dabca76dd9100df7c137d3'
         'ddd99248002be7b10afd87a208eb4604'
         '7d56ff6ba3becd015e84091d26132d93'
         'ecd6708aabea6c46f34dd97b4bf06e7a'
         'c1461a6d098cfd6a682d5385cc6554ea'
         '1fcf3b3f470709fe826845b26fa55e0b'
         '652bdfe7fc28e06ebe4255517893e1df'
         '79c3f2efd92599c5b5c9c592545c6625'
         '16d3cf4322acc436a5a0db3212f07e41'
         '2f168864e7498739816cda55704fa55f'
         'a455513a9b3debf4876556bd4ffe70cc'
         'b4f0db4adb8955b9816eb063ac00cd84'
         '4acad669e177b3bab2e2e916d7de73ca'
         'ceca98ae3f12e94d61bc7b33a553eb21'
         '48cffd7e8d2c2d72e969d93592d438a3'
         '95b34d15f7d325ba8176f60d5aeaee78'
         '8de4bdbcbbd7e542e5d367afcd29fe7b'
         'ac93e65d53d743d07292bbb4ee86205d'
         '88a34cbe61194bc3aa08b4282677cb8c'
         '96cdcb693e67474b3099ea75d38b8334'
         '662830979033675731291297974bded6'
         'abc96e57898d0c7d6d7fcde2437e3bf8'
         'e0c521dc9bde11101a7172fd691d294b'
         '9e9cea3e6ab5cfd92278a4b13548cd2f'
         '62350c07bb487edc639c74190c5e3e51'
         'cc3378dd183fd4ecd60c1ed528dda0e8'
         '1225b2e59720a3f915293dc247f8c1ee'
         'b9e6ec982960e70ddb70ff984df13c4f'
         '799b8c50a5deb9e57cf5b423527fda1d'
         'e4756e2ba41cdc2560c1ac76f9b679c5'
         '06df08b591cc51e37b4f2adf4fbe7dc5'
         'd0b4b4c054c4ca5460b4e43c4c369873'
         'd712f4eb92037a4647939d6990dcfc01'
         '6447a4521787ac8f86a82f529777bf9d'
         'a060e4b97dd3e5ebc179df1d5b0b3f1c'
         '4ae3ee9d382f8660300531177018aaf1'
         '181be98b5739d2761a8d3833200c1b9d'
         '7191d7cc3926cfe234ae096d6e7fcf4c'
         '4d9453d15bd61b150c212a24163fed10'
         '541434da7e4e53c6e339e12507d0109b'
         'e4fa9f1b5cf8258d397e2ae3033f91e9'
         '8b9df9fd3e7f8944fbeb64dd19fe387e'
         '58efac5dee1a3b38d20dd33614ebf594'
         '395ad3feb60c3d4826bad7050f313bf1'
         '817f6168c19f772319121308ed434b2f'
         '5e8f23116dc22de63b58de223d5809f0'
         'b54e7c6e91de2aef3242108a5da72d09'
         '2b654b72d23377cb1a8fd93b9b776b8f'
         'df8a982e69d12dffd233a3514bb2005d'
         '9aecd07f2a72441d76d80c06e48c2278'
         'ba12531c13b5565bad5fcc1f5f2d0381'
         'a5f970c2dfa5b22707e2d6ca593e1954'
         '074e6b787cad1ed0ee09c0c65e157662'
         'b9e05dc7cdf68fc382f7744ad4910e50'
         'd0a778602bb065b3fa5883b65a8313ae'
         'd3dc21cc002534496b02d6a030c4ab81'
         'f64b23f99e3c80ec8afdb5c258415bce'
         'f3243e82453d88311627c56716879039'
         '25e49f715f314dc6d776a1c7a80bc087'
         'bd7126d145e2327023b60569d72453e5'
         '556a7b9fa67d32a6a3daaca9d19eacff'
         '06522d70956f5efbeb2fb7c5422938b1'
         'cf6f727e413c2fa6c0a141b328378f4a'
         'c9ade10ee6f96c5c7111d3c10bd55dba'
         '09c9a63a1f2261f6be57a9cf31f88ce0'
         'beb780197b57ee87101c15332f4c8f67'
         '597db122b2821f58b350de661a55d8cc'
         '48e75e1aab83569a1b81f5d5cbf258e2'
         '83e69550389b35dd79b2e39121ddb71a'
         '34b1e38c4df2543a1a345da834934e9d'
         '3870209c8d706d6a605ef2f5a51bebbc'
         '832795debc2118882ec6a978a96ce41f'
         'd46d2e48802a625c3c7723b64d7414c2'
         'b68d6322e7c77cb28b2c645a26ba9fbc'
         '86a7a17677f674734bd90b7c5a3f6471'
         '77e0ec9f1f6d1240b37d33998887b2dc'
         '01cf0bed696b76294f8e97fe061489b9'
         '109c0951b443a8b4c839fd6370d94740'
         '046e837423ef7bbd8d7b6d6e7089a1a0'
         '40bf1df0dec98412a4611f2881c1c54c'
         '07e34a1153691eac6ad560d07eb66ae1'
         '26c68f1d0c64c2b4c270dba112186986'
         '8795beff235c42e776b8e55a22379f6b'
         'b9c25ddba5e69e3053dd189ff5f30010'
         'b3c5add81c0f19e9b9ebdfd9a4849a1c'
         'a5f03f26fb434337a12d6776c75562c3'
         'df703790759454d920f5d2c687eabc3c'
         'a88bfe67f10cc87f3ff78de7d2f339e2'
         '911f7422a52f116e114b21b1af1923f3'
         '94db0bc3b941f701c9f6e844615aff8e'
         '84f9ff30e5c66cf060e72f76f90e3a94'
         'fa4f624fc26b8b7fb5f15ab230b42aac'
         '8fc7e0837e74979bcbbb8e106b527c68'
         '0f4c69146123004d70c537764aba4bfe'
         '9f17a65796ddf587f31c927130eeadb2'
         'ce0fd6cc24773854d370b5fa94d394c1'
         'd97640e6eb625bae25c4b0f02f23e060'
         '953e4a494723ca1a9f27eb1f9ea1fee3'
         'a4930f25c1c5ffeda910d35f62c9a09a'
         '02bc7b29abddfd4fdc225461d1f5b34c'
         '3beee3dea0b335d6afb9e0d5a8ed96ad'
         '284e3628d27054f12120e06852df1b7f'
         '21a2e62d7dd4b5d22b1c6f3fbbe96608'
         '0720719ed64375a46b12323e6babdf02'
         '277df77679a9bc1b3f78df7a08b482f6'
         '214c51bdb5ea8637913fff18f005503e'
         'c6f8e82d0aaffaab2c333ab58849a456'
         '256f0afd3baf54f2fe496f8ff94af349'
         '9efaecfc595cb4c9c493182455106f47'
         'f998aa6dd59576a7e020dcfee0487f6a'
         '6503087a12f5554fa369a888e4eece67'
         'ee76abf2bca1f35fd28febab38ef0a12'
         '0a454dfc87270cdbe28aebec89d5eb4e'
         'e3c565732e97635b5d49324b49a123d2'
         '4ce390c340a1c15624fd854400f8b0c0'
         'e65dddc0754a6f99f7997b7d83bf093b'
         '52277cc329dfd374df68819a647b4712'
         'e1b114e0cf0932f43eca919658a44fbb'
         'bbf5788c07b6a711c20b02dc661d2578'
         'c368652f64e053aedbea0129694d409e'
         'b96061cd2884d0786b53a6abc46d88e4'
         '7804177ff2220e4213b30623688b729f'
         '703636ec7091f3ae88be930bd2807cc6'
         'aac64b8de87a36bb94e8940258c6252f'
         'd7c7ea303ec1c446f372475e4676ef12'
         '479eea60d6b916521409e2d08c4880e1'
         'e19f9a3428ba1af2d4ad439f5a11e2a9'
         '18f61295d1b4a77d427b812a732ca1ef'
         'da73cf646653c6594ffbf787a9529f46'
         '7b91ece530765e580f2c469966716207'
         'e8edf118acb79795515f6141202cf0f4'
         '3055c886ce3e5260c37597bdcd289c97'
         'fa25a359f0297983d806ca22bb25ba85'
         '11c23c17c7fc6681dd251af3965364fa'
         '608fac871e26e072b799314021757187'
         'b6c0a8ef92d7ebebb731770c3b0ee26d'
         'e3904dd58d41e9a80ae6311e41820571'
         'b610e09e3c6233052979dc26f47d7bb0'
         '3ce13f880020575d5e0c7c714fec0096'
         'eef0d2bd2686a08c4e976e12ff755ed9'
         'e9fc508137134a6cbc2ea993ab88dd0a'
         'f6da2ea3dfed67e3deb5abe6705d7296'
         '0611a297ca7517ac5411716a6c411f25'
         'b5d36bdf64b09fe98ce221795422a702'
         '763e94d070d1a4b32d5ceacbdec5f70f'
         '1a0f1e6218f6c3723c73b52ac6067c9c'
         'd3204326a96f2954647f1adb526d40fe'
         '0f27d69fa6f2dd8d179fcefca07188a9'
         '10f551e228b13a0bc83c0287f6ee2fff'
         '015e84443ec613248b3ca7da15b55e7d'
         '11f7914912ab98d9d535ca453303222a'
         '402412bd3cb893ebd3a7bf9ec670378e'
         '5ae0870cf67e753b8c4d91ea4f02d63c'
         'e5f5175ce4292ee1ceb6442d88687a29'
         '643d1eef9c064e2e5e2bd9591f931a83'
         '302fe33aedb45146fde735dd1b59f3b6')
