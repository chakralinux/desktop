pkgbase="libreoffice-i18n"

_rcver=6.1.2.1
pkgver=6.1.2
pkgrel=2
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('b0f12044a85c2e5803b54cfcc0f2f800'
         '086512609cfb9ac6fe0b20e59a08d3b0'
         '750e6d424bd7e412bc7b2b88cf7e4407'
         '8fd28088a3e3174d98c43795a7f6ee9f'
         '609e5024d3c714b59142c5946b5600e7'
         '9e95a7c14099448fdaf44654be572d03'
         'cf0e25b31968292a61d5810e1f85c85d'
         '61befee68e03e3e80e36a7f2c0096243'
         'dc608371a75c9ba4e10d6239fcd79e13'
         'b6c820a5d5c07e8be902451b35a467cf'
         '42c19407bd5a288f8d7f436eefd2dc84'
         'ddc95b8cedeec8a555c1ffa15f4d3ddd'
         '77ec8b2c859e5b29bbac82251dcdf5f0'
         '9704d5c4ef05a8f14ccf80546bbaa965'
         '1d1da896d917a88cea168518faae79f7'
         '4a8f00c4c3f6cb25ccd5bd4c7b0d7f80'
         'b592b27494fbe43f07a4e286a97b1ac6'
         '8efd124c08394f474ed1cf75cbd4412d'
         '0f4a5dd28a26b50f9244ea8adfd70ccb'
         '6fe1743016cb0889e67388b4fbcfe9c2'
         '5cf3575de7302637cc04790f1c554793'
         '4df4001fd3ef60df7a54c6085047fd24'
         '98231f434fc5c6ea64f8519b2cb31708'
         '5c9f4d8c45c2d0b16d2a49e72ef4e9c6'
         'b9a4957a030bd512cc4144df12a3a717'
         '4fe211f8c1c6317c1cae1e3f7275b34a'
         '84695fa48ce82fd6c9f8ac482b8717b6'
         'a43937e56d8e8a6a5a6bef08a8a25be3'
         'c37d423983fb0fff792bc8ba38696ed3'
         '04ce064f98c55d6d990dcfcb59991027'
         '055e331ad0a2608cc7d3e74b4bf0dd48'
         'd1fd00664395f840ecf19dd0974a6c69'
         '1425b07e8c3393878666cc4991a6bf70'
         '2608e46825a634f07037931eda84d089'
         '3a4a93fafeb1ceda1e91a85b83176b35'
         '060aa186125ceb7dcceb8dc3641bedd1'
         '7d3ea62583ada4403c7e09c275ebd8f8'
         '0db4d417205091f33d228c31fd775abb'
         '1b6349504d2ffcf8f77baf48ffb2fe25'
         '4b2d45aa747a1f34c0d8b3049693616a'
         '69f8b52a3e04671ecbdc8a2a88585b91'
         '9742aa753d181856ba50eecd560a0dbd'
         'e86969cac3d7ff3df6609bbefc8e65f1'
         'fdc59bd02d7a7d85842315c47ce930b5'
         'a8751a3d2cf72564f43ecac5653f96ca'
         '7ff3bd76e618130e19da91a112c7a06e'
         '9b5121d7761bd4e2610a98d08401d863'
         '83634d046024fc3fe71e7d9048f76311'
         '683e193154287e2640c7704aee83943b'
         '7ec0062a593c42d5aeeb3f5531e87cd5'
         '4ac58e5773d4c265cc7c46e43be98f7d'
         '21558c2ad2b04d8a6d447b8c62f608cd'
         'db15e4183ae150dbeb692e1fcacb940f'
         '03477e8644290e4e96f0326288d3fc0d'
         'c4c14f67ec3e5ad0df25f9f9767340c1'
         'cda4be0fa66675ffc1a6e913bc936bcb'
         '243495807891d19e92a46ba27a28cc96'
         'dab0c65a8f3a9a6f96285fa23c81fac3'
         'ceb579ebb1976bb06d4bf4e1f5d78ac9'
         '68cb570b5501aac285e9c7d1cda8bfc3'
         'e20d2da84850713bc661fcb10f8b55b4'
         'effffa7f02798e74da0b39a5cddae1d4'
         'a796ee99801f223b08ef34a2c608bdbd'
         'e23bd9f2cf4076f47aa802c181c0a77e'
         '6448804e822a235120f15af9dd5c23bc'
         'e4ae55f416f3897376013d69f3e745be'
         'cbfeed26cd6b257f88fd0cbb2dc5d87f'
         '15c0f38b046a4823e513f1198ec6f2f1'
         '5a0e0f8b082987367e75f13d099d1acf'
         '98c64fe4d7a3a1fdf900cb6c853aa777'
         '47bf5273e4d4d2c9a5bd689a8df3edb6'
         '78ed2a3db6234a94e4fff314280babfd'
         '40adcdeac73680ec8704cd5afdf0f74c'
         '1f3995a24a34cbcd8f0537ee56dd8c21'
         '6a9f09f4c686cad49106fbdfd39af8cf'
         '983dba1aa49fd6eec6a8473ce32c99be'
         '50218ed29d72f2ce628397b8aa7975eb'
         '741b26442006ead1c59e25453c710477'
         '7197642d62dada428cbeba975aca3d1e'
         '628f9fa6b1b169e27ab19f029e18c345'
         '83bc163b2a271a22fe569ebf2ce1e5b2'
         'c161dedaaa037d7e2cad9fba9630e795'
         '76e0dccc5e76fadd72225d4637774eb4'
         '2dc3753f796ebf4989edae1866bff153'
         '39d739e06b085ea5f468808955a6ee04'
         '4584ded7e741ba92febc0f71a78c3ab0'
         '36833f454c86949a8c7fcf3d2017a351'
         '8dde448cc7bfe4145fe1cc7262b7cdd4'
         '9647876dbec3a950c854c7868691bb53'
         '5b5ca01fe66588de63d702b059f1b9b9'
         '1b5fe06de06b6ad34c8ff7f942bf3b90'
         '851082448ed1681a5d4333967f38c117'
         '9bb6767390c225df10428e11e3f8a8d9'
         'c45698979df5370dc27d6760351b863c'
         '9ca58c737eb722e47d13d962bfd5fd58'
         '8dcd2dcf2bd120df7d3cece00d3576ef'
         'de36d0c54f0a5705922946a2093f0e77'
         '464cb8203f9c1f921f1473d266480457'
         '5fa371fdcdd401b259ae716e8888c50c'
         'e6c6cd77c01cf4fe1431096ab1732bf5'
         'fd8414de3fd318daf9c30ccff87947e6'
         '6fc1398c87b6af54c26f3f8e6b244b4e'
         'd869328b672edb4de22e18d8af760df7'
         'f11585f6bf7ae28fc89e7d76b5fb72aa'
         'c61e9b32750211c4900346a985613503'
         '6a19b066fd30ae67357dc1bd02c94ca4'
         'cd473b6b5600410e59f55ba28fe4bf8b'
         'bc859e09c46b0f7a83f96f602d347057'
         'e0094a508bfefae14c91ccf646388cea'
         '0e52719dcea095e358db10de899511f3'
         '8dfccc3133ed84085164f5084d38b11c'
         '6034a2d52ad1091e9ae9a44f8614df0f'
         '71e1618cef713bb5c3502150e33179e2'
         'b98101f8d735da8cf0bb0f344fefc3e2'
         '0232d14ae49199eae815c018db4991ef'
         'cbc56bb3882e88bc112ea9ca95226176'
         '77aabce709af52b9a56d814390039a95'
         '7cf233c96b400246296ec03929e17b56'
         '830a6095180ab9c9b343ca625a7dc3c6'
         'bbf6d5b1df38662e657b3f4c9c7737e3'
         '09c7da0194f3e73fb56a217dcdee7a9b'
         '54fe1a7b746c259fc38e1a2d30211661'
         '9852305fb1fbd1cc584ce02e3a6705a6'
         'c3c636d44675a9e5c80f0c67eaae3e0b'
         'cb9e35c52f3fc9536b3394028705de88'
         'b1f3f0d1ad8af68cc2503c97cf6a3b17'
         'c52f2df7040afea83cb35d99fe13ba52'
         'aea183ee43cb2a6e15e34246efc47bee'
         '253da4ac2d8c41a194d13fadb0bd0e5b'
         'dd698739b19e429c51f3496cfcba7e8f'
         '048bcef8f8190c771b9de0e5775fc860'
         '1fdcea86cb3a0849d6d38f64956a304c'
         'f80af47bf0b04f593f57a080067216e8'
         'dea6eeaf2b0aad654ee3dcdc585fbcae'
         'd8436d1cfffd6e96ed5750ba8818fc2e'
         '9f1875eccb1edeeb0e438a32b0c16c92'
         '31ab984ba63f51b5c2db096110939a9d'
         'b698a3553f05fdedffc775e8075f9cdc'
         '9509d6a9fa901f4d0c40377c640b6325'
         '2b16f75758e8565ffb3f461251ff1817'
         'e82b0c1c6827f7acdc02592873f3f042'
         '509596ccd3ff4cdcb8dc85511e55935d'
         '76c9d607548f5060187c10132c03311b'
         'f7f07b33e44d692504a861e9eca96e96'
         'a9cceaa023bd9bc39357a6e25a43bf4f'
         'c2c7154c1736b359c84a4873dd0abca6'
         '85ad1963a4ec3dcd7e5b1ef1c7deaf16'
         '94a59a8fa53046a70c9e8b97155f818f'
         '116e9a36aa1dcd40f68256127b2eaaf5'
         'dc2a5cb5b285339cfd77cbce0c9f1b82'
         '506b9a87431cf6eb53b36635e1f4bfca'
         '01b1db024eaca984b49d8dd8c0dca5f6'
         '7696789e51747aa2ba27bdcda3be74ec'
         '537750f89ff2f514cdcea4392c44ff3c'
         '3e1ff9821cb98a35b6e148990da5c786'
         'f821228123ba40886ddd307ede857f98'
         '16c882cc7507862a7a43ed77e0defdc9'
         '10d4d6859f9d556cf489080a1945cdc6'
         '0c9a6e119beb052c20f236843b1e2a74'
         '995d2196672b6f3ec764b918a3f00d99'
         '255a5978ec8fc844f9baf74c4dee582d'
         '10a1a1fa06338769c99f372e6af9eae4'
         'a28a77b2bd1219c2eb1fbc52794aeba5'
         'ff4ecec5ca84d2faf0f223a6cfa88ea2'
         '33417c9699a61a6dd36128caa6a11dde'
         'a1161973965f8ef04c56b465c8249c59'
         'd1b040354fa0c41661dd09d6b6f93eab'
         '947c199d78d1708c775837aad65de9af'
         'e06216381738dada3d95d3e5cf0ec02d'
         '405cde10991d8512c680c89c0459a268'
         '2137dfe85abfa7667cc10b6c91e047b6'
         '93a9567ab267d6a8cb71353374153678'
         '4eaa020c9193723346fcffc778ee1ddd'
         'e173be6981126ec04eed25bf0c6956e3'
         '4118bc0abc1d99647f45147a4cffdc84'
         '4647eac47760ad180d8bb2adc085f6b9'
         '9f2bb5f2539b5948381771ea641122d6'
         'deccea3538549761c28bda45fabde855')
