pkgbase="libreoffice-i18n"

_rcver=6.1..2.1
pkgver=6.1.2
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('52c8dcf61146cec3c30c6ccfeba78cae'
         'eeb04ff0e19755beebfe1624b33c9250'
         '10737198cd8fcec16fa0a6f709532ca6'
         '59fb628e5a73f271249e4cfc764d2f24'
         '9801b03f4c7ba30590af2987466518cb'
         'e391aefb29f4be9f1c3647634d92d8b7'
         '974505d1e3ff31b590755fa18f80f788'
         'a8426ed2474472790a45761a37cba70d'
         'e0b917356f53f17632c77251ecc3edc4'
         '26958d29cbb7cbe2a53f299d5e1c6fa1'
         '45c4d24a4c483fda13ab2118076ed8ed'
         '912c55e099575da8fb8c80fff3fc24af'
         '085a15117ba1a47db9800a9e7fecd396'
         'e537d132eb656338da0f23497306eb6d'
         '043b96dce7dd264670540b930d06eee3'
         '00b845efb8480ce6d9e5e5848b627950'
         '2dc84ea82497d2149bc2a1007c1c2efc'
         'd33cccc9d7e56f6f556adccfaacfcf6c'
         'de21bfdba65397a7b207525847dab2b8'
         '625a64c5899ac0ed27e6e1714e95ae62'
         '261ab3fcef5d4e041fe4bd3bd9ad904e'
         '224556d8c36507141b11b702c372b484'
         '7c10fa048532894dbc8109fc5ee45996'
         '71bf61acc841fe415e9957b522e55b57'
         '08bb920b60139278966ebdae8b336681'
         '7cedfe287bcd079e12d5199f0bf407fe'
         '3a7a48f6fba61617cd4292b802221c6d'
         'e52cd55321a8ba37938f7d29280b19be'
         '4a23b660728b65bba40123b44bc67ebc'
         '66115beebbfd71d31a22b8f96d0b7824'
         '7b73da17392d10738f13254b27be7bf9'
         '43c6bd52630259de276cd12e7c0208db'
         'fb6ca5a631a0b57e06c21824f6ba5f08'
         'fc596aa38ecfe9205d62a2807a3573d0'
         'bab6c75ce650175db3c80ba12e2e1d79'
         'a7ec558d690d0a859b887b60b8f4d61d'
         '14e8deb0081224547af88350abea4795'
         '608b592f3ceda452c7de8079f62bee6c'
         '36bbc58c66ac7e17cb9d0553e8f72e38'
         '60de9eb71a7964256aeb67423d0becb4'
         '89b0cab0d56dfcf65d60f654b88e6981'
         '4fe65ca1cbd9494f1934ecf203ab3a95'
         '2997fd30f865f3e4290ccbe53e5e63c2'
         '885010ab7311b07fb1d59c8223cb057e'
         'c3b2f2e5286007453d0693e1bce1a0f6'
         '38919af217bf3662d624fd1de755bdaf'
         'f83ca335f2e4eaabd05fd95863e2ca02'
         'd552562e3894821e061ae0d275c62778'
         '842ab178b8f3cbc6f905dc33d820f549'
         '3221fe3acd5ffb54bc5662a4cc7bb970'
         '40f974891f20cffb6fd77d0785798f87'
         '084f3f511148ffc9ec5946160da2c41a'
         'e50115c4638c6eac05c45a8c49f75779'
         'c8b12b20b3758c45947b8be718ca766a'
         '84144b6049fd6405e87ad078dfdcd0a2'
         'bf5437a3f3b516690e248b96bb27ad90'
         '1ae06b813e04eea3a481d1cae0897083'
         '31a4f309e4bd5fb7461d975df10cdb04'
         'eb7219e7b6f7a3c681d94c9a29b26321'
         '43aec7aa599ab38677f31e37ce61ca27'
         '4d3e9365801b76f7998431da4a43684f'
         '61febdbb9ba30db7fc1bd31446aefe20'
         '0d99753a349882b9a34919d9ff2be514'
         'd9640b6c5b74205d46d9c29840f7c9cc'
         '7e4365d8cb9ba799c554da4bb68097de'
         'dfe2ac8c3fe7230afcd98eafe0417c49'
         '879ad6932d78049d305e95c6b52c0c0b'
         '315a0634cdcf8eb6bbdae872b053d228'
         '6162e5c72e728ae2ee1910588f7486b5'
         '319ed3bd2b9aab0982d8b47112009119'
         '7c39cb01d9b7f98516af47a79714b758'
         '36173d2d364e772c688d83e8d6e27d28'
         '9ac56a792952ec53f346727a94497409'
         '1fc11c3c0d4cb0e6438c8ed1e3845d97'
         '80738cc1556b9e983219c5d5a8418f1b'
         '092f46b6020b82ffd847dfc10c8f1581'
         '9a4502e1be760b2e31eaaf221755fd7b'
         '9044926981556df152cce621b83c8603'
         'dfd2ca9f7f037f07dbd15b1ae7b2b0bb'
         'e5106eb86959d51391bfc849f9f701e2'
         'fd6389eead5ceee61f52e4e391e15b21'
         'd11e77ee48886c4de8570aa0de18448f'
         '6f3a36c5bb42d1d45b46a01f7b0a6a53'
         '3608ef8967c7bd9f26a8534f2666734d'
         '84cb30652fdc2c9505d052ce5870caf9'
         '3e7bc6f1712434cfdff233e45fd34b0b'
         'ab166ddf260083c74abf9e345cbae0eb'
         '2e19ae2509a35682017e6be52fcea6c0'
         'b5e67543c07264023db7ca2d225ea675'
         '7591a8898c01364d3ea9a62b18473312'
         '608b6c58c4f167bbcd8944b9c6c6c583'
         'e67d91483c18d99dc4d0d7d5dd902d87'
         'be17b40f448aa89d42a8288cbb1c3f8b'
         '5255e7b5e97bf817809a56dbc61a1394'
         '13321a3410cd66adb2ef570b8cecaef0'
         'f4725e53b41a770b79f7c5ea37d3ad56'
         'ebb09fed04432f89e0f72b3c36c9b21a'
         'f9dafcc4b1647b53a56f937d7c30b5be'
         'e0f95f91d227ae7417ccb1b0a1bdf06d'
         '3bdff6637c260edaae5eb1c3f840a4af'
         '97828077635daa59aa6e1a22e19b2174'
         '43a85477ee49c1755085e011b25ebf24'
         '3ccdea25b52e62d3e5c3df447c9f5ca2'
         '37b748e1b6c2f804828d1812a96a3e72'
         '5ff72508111444cca21188dcec71ac5c'
         '26b0f54039b423d7f535377e26f760fa'
         '2f24d7815213cf7813a69805cf4178d2'
         '93001733038efa92a4342468c646034e'
         'b3c83cd3ce03ed5024f376ea6e9456bb'
         'a3ed49497c8cf7c60237e9fc7cfe4589'
         '0cfe3c40edabd4c8733468e0900d4b9a'
         '4d51adcfd89009fd32f26394c24dc2ca'
         '5a98d164fdad6d3ce674b157005202e2'
         '7f03097fd2c6464e75d1fac583154719'
         'eaf32e817368c7bbdaee5b483fa042c4'
         '7b61ba13c5beb7432f45705e54b6e822'
         '1ce8035e8a2c2359340176f514fd8d3c'
         '63dc4f526cda7a4616d01d8253b069dd'
         '95ded92bc54587a92e4fd58b0f6363c3'
         'e5a503e51a1fab245325b34399520fb9'
         '67733a334db4ec53dd4601f0de1cca8a'
         '50758fc5c99d95bfab52dce23c8d73d1'
         '8af7c80063695b474ec57d5757ddb32c'
         'a9d29fb961858b67fcbcbceb6725a0dc'
         '38de63a0734bbb19f31bd3edf278ef3e'
         '446e807627af276996da8ab39e48d111'
         '3109b76018b82c6cfe4aa2f599db76c4'
         '8e5e7ccaa590f58c29ca4c3e021ed3ee'
         'ef7c1305b5aac6ae521f8b5f23cbaff6'
         '98f0e7f20a6a96be4ea360c9acd9cf55'
         '13dbc1cf3658e10a7e9a48fcdeda7378'
         '880cd1d7e3cfe404f4aeeb867decca22'
         '0745bf4b40f67cd446f9778b64dfa23f'
         '05b500e78f16f3d7fc6fb2121f18c0fc'
         '1e775887d6652b7eb12fa169edcd09f0'
         '2304d1609e2c0d8a836578769c992378'
         '2c8c61dc1a712d3f1c388ca6e63a2d4f'
         '9b56fede29f23f066a4ba0c260750e99'
         '8495f7364cf44b741b8095b29eec3fe2'
         '4a14f8fd5f04a480b73524b4de6df4ec'
         'd84573ff942eb455dd165b373d6cc4cc'
         '0965c0d8c3f1e107ff77e4aba3d02306'
         'a73e0f6edb6e1d8d2e911a8b99b449fd'
         '6ccd30c47a8674ca2cdd36ea8690ab60'
         '908e156dcb83b68acdb043539d1a42a2'
         'd1afccb56f0b205bc627fb6460b7f40b'
         '91cb6f60e0d871811aee71fac5345400'
         '91757000f4467bdf16403fc474bff1d7'
         '974fbd7bf79a5d9c4979478ab7dfc452'
         'ec783608d5a5c5eb5c217ff57f8be78e'
         '1dfdd1fedcb73530b749193dd7764412'
         '2d247a825af35f89151e94421f19da50'
         '8372243f5c429e0c7115ecb1b695eece'
         'cd15bc1446ab8a82d7c6b304e324b131'
         '1fbe4cf97eb0df28a6de0bc203e8d9e5'
         'f218a12bd96b33b9de0335488a3662cf'
         '79f92db7b6a62ec7d6cd253fcf256005'
         '244acfee2ecd1731677715f3606cb6fd'
         '62c7f8925206488c12a3d094c2d19486'
         '698cc7689c9617b1d708554c60dbba10'
         'e94958851e150f15eadb09d2512c91dd'
         '27946c5d83b27fc1e6d2e98fd0348d96'
         'ae480486c50a0eef5e69e85bcbe51c49'
         'c222c1313f36b451d91e00b2879d020a'
         '048981c93cb8318aa054e8129f9edbb0'
         '4e4ba4924807ed1ff9d59f877636249b'
         'c40a2d346d284eb6c9daee5e1f28e9d7'
         '325720739dfe252c542d627ef3087f77'
         '8e32ea21a6dfd09e1fbffd9845b6c400'
         '94e84081f118ea1903611532e40b4eea'
         '6bea80172f02e9609937b6075e7100be'
         '4360b90112680d8d253c5e6d73a1be33'
         '6405fbf2c452d1e4355983eecb040694'
         '3e46e76bd277d63bf5090d8bf4bb8d84'
         'cced5d35b94553e68df85ce71d35d832'
         'f51c076f1c56aae53ddd11cede17694f')
