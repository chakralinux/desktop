pkgbase="libreoffice-i18n"

_rcver=6.1.4.2
pkgver=6.1.4
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('8bc7c9ea1ade31d5260970150e079e3a'
         'b185d64ade7ae58a30d144ae2dd6e71e'
         '7b11a272bb05c3a79e835e08582adbbe'
         '9033ec940e0d52417d176a23365368ed'
         'a73a332b287d2aea7f2efc8b34636be6'
         'a0c482d7e7ba6cebd8d7bfbceb3a0c28'
         '3c5cec31730b6d90aba9e91d85933c79'
         '8dec37ce3c4f2a518f2867db6d86d20c'
         'a5eb771744e6e65bf0486ad07191a8b7'
         '5e3330988e5688ec0827a2637bfa6493'
         '9b53c5253dc7b4efc052e040012fc90d'
         '4129c851fea99b5e98f4aa3e3ec64ee7'
         '48dc4ebb1c441945c4906e23860e4211'
         '5ea011c89bbb72d40da7e83fc7ad6bb5'
         '1d19ee917369d10bc799eb283a4d860c'
         'd88d852ef5b692170598d766992e6e7f'
         'e11cf5651cbe798af53c44eb3e083b48'
         '1b2aea75758b4ceb0b5584b5d084116e'
         '0fc8349fc89e365a87a74ebabc342181'
         'df7fc7cc9c0c6032eb2fe9fecf248046'
         '4ff71019e0d3344061a38c8d50413c7d'
         '84623409a1ad9b90f13b7b6c0e0d07b2'
         'cf821764c7145a3825763b56995c3588'
         '9cc3bd9c3d0e0c53d1a3fbe9920af6e5'
         'db6465596061a13e3cc6d18bd0608206'
         '2bb471de201de19f2cbdea813ba3a6cd'
         'a68c7edc1aece3caeaeda40f7e8acc26'
         'e6683bbaade24db2567f2bc53d70be56'
         'd0dc5f9565ed465070a288f49a9d4f88'
         '6e6e7b04b52aab27b4d1421cbab4913e'
         '5d731f4979d74217183a7f0de85ecbf3'
         '76fd878158a088d82cbe86ab1c3a6a21'
         'd1a0b164f069bd18b345a458a7bf68e9'
         '7cc882e9882772bec82caba158ff9075'
         'c9b7b2240983ceb87c85710766bbde4f'
         'd73f38d4cdd7503f9cade9060b44c136'
         'fb0a8bb80df80b0fb301aebfc7d588e9'
         'daabb4d99b5008c5c9fda66954759fd6'
         '7a6352e86d24aafd819da01a2447f016'
         '797757e6179a1e02ff3cad68028e6b32'
         '167b622f1f0ed55b1ff72d7988590943'
         '46e641814c8541e78476207884ab9723'
         '5032b652d11af84a6ea23d7342170399'
         'cd0af87e786faea7a13bb22b1937eb20'
         '3f9dd7636fff73e8ce743cb1dae06440'
         '4b17564927945932f2866b673c4eb494'
         '499eddb1906ae5bf66e5dd490b2346ea'
         '3799811f0d2c313ae18445fd24232f2c'
         'f79b1b2ccf00f08795b0f4da7754b4a2'
         '17ebebea7c7c0a7a014f5bcf512bb7f2'
         '186e5a9dadc8a3b49e6ec0812ebac0d0'
         'fe25d137737f34ea157f739497307ac4'
         '6afe9afc5dfb9926710bbf21c8f90281'
         'b6cc53985ab2eb3d521367d03f7be010'
         '4f48d3d8102a8cfd1dc7eada5a9552db'
         '198ae5503e647b4ca56cfae24b708798'
         '34cac53c5fe1068c58d441715e6b00f7'
         'ba650c9f3114a36077845c5f05bd8b48'
         '055cb6ce3aacee21ad0d7f959b3f2e0c'
         '66a6aa8520963a576cc8ebe84255537a'
         '2c3f312a672e6e7a6d34cb14e50342bb'
         '7b85a5345eae3f08977b56596476afa0'
         '291d549fc84f1965edbf541ba29e71a3'
         'a1ef62b4579d8e16fe238821030780e7'
         '6b2623b15019ac2b24071b40b1eee71f'
         '7073462455fc9c9e7be654397fea4a98'
         'f9d815697af108a67be204c037163dc7'
         'fc26c78f6479a99a087c2046dea56996'
         '4d59efa6367d1a02b2b718536316c75c'
         'a823b31eddf2f366c5df9bc1dc26b417'
         'f7bc4d4e599e373b4e1d340c356d53c5'
         '00a45642cf7fe1affbcfbb94e91e7917'
         '013245d2d2b7fce52df9c002c8747778'
         '57a038f2625bf4ce7700363b45409d5e'
         '76213516e188c2be7f917b6e058d456d'
         'b3b181ba72404a3af32f5546b61beb13'
         '0791174c043ef05e9312872b2578b798'
         '7eb1a4ae02e7413074a63fe9da8fedc2'
         '6cf7a380a6f886542dfb0d40b97fb653'
         'd9c4e65e4580160caa9427f69345f899'
         'a9b1e02c6a84333b881121f9550e7c61'
         'af4ea2c19f54c24bb40c5c5f6235d477'
         '089e128c8776fca49cb6869430235001'
         '385a589c26d27ad8144dec882ac28ce4'
         'ba59b75f0c2d10ab5349e82572a0ec66'
         '659310367f387b8b79c6646ec1070880'
         '951d094ec4a5a8f13b405d625b5b6dc8'
         'edc7d0f329ae3dfc27e1e1dac1522edf'
         'f005d36f3c90c78c71b46c72dfc92fcc'
         'e3b2f392843626b628ef154354318f32'
         '1b2d83cf559b16e672a0e1f50ad7dcf2'
         '7d27ef884717e87c1c66aab8cb3b4ec7'
         '18a14cc265f9118bddb572f9ad3c60a0'
         '004168f4b76203e8af945b17b63f2c72'
         '9720e031c84d08f07f9dc7ca6cd226bf'
         '692b2c3df10d8f9d703e0486c54874d4'
         'f85c3eab86e072fcef881ee4c564ed2c'
         'df3886e587a880a0bc4416eaecb6c190'
         '450a0cdd41878e86cadb5c7d50d4ab57'
         'a674da4a614f173e3d0534e3c5b88520'
         '2332c5b78c2a21e4bc815c84994fe576'
         '764434e9bb5d80a69f6ebe8e93f32688'
         'afbc85350aa1d7d3c18c3450b307f20e'
         'e201886b8065074500e7a3e8d1e33f13'
         '59cc9af7777f6efbda89d0a558b3e19a'
         '7cdf93a93e9b6b445eb283bfc1ecadae'
         '0cbad90ba38569765306d9db33b4a157'
         'c2929a8da6439a3e49acf7dba7883c4b'
         'aaf84770434d1d21bd65f2c130101b03'
         '64f5bd0ad775e507e661221f5273febf'
         '63b33e607c21a84e859b95380ddcfcc0'
         'c6037d33ccbcd17250c5b238b23dfac5'
         '6b0599cc4a95aa3d583c05b9e7606ff9'
         '2e64f8a47f052167c89d5a2f54f70b16'
         '24d51871e4a8ecc3481cf48edfba65d4'
         '41f2a779cad3e3e52878003620cfccdd'
         '653929ca692e242ff7d6571e9d852f1a'
         'e9d8595e98a468dc2d60f8a788a0c419'
         '2beccf5655f62665ea6192e3a0c3fcb3'
         '3106117eb06fb0f3a687a2c1a19c84f9'
         'd55c3575311845a28e65b2c73cdff07b'
         '63a3636d52ed0ef0829d98bcaf430397'
         '8dc5da505cd48b16bc98e754c594e1ea'
         '87c63a73e4599e8b5394e40937b663c6'
         'e92ad94e48f2fc0c04d1a0ad73904e09'
         '164112d249d879647e139f722e7ef980'
         '35c1918267aa0fadbf7d304cd877752a'
         '29a83d0f4220cac90978a4863225cd36'
         'f16912b70d2510a70f7dff602336cb03'
         'dcaacfa10315db7a75a3bef06e330917'
         'afb84f1e0e97bf1fe3f5accf65f13a4e'
         '9ff53146b1f99dc2da82434cd10fcb32'
         'ead783fed5aad232b62401ab50dfcdee'
         '9c56216d4199b4e73fba652106900313'
         '91002a01bb2215f48d081a15336886a5'
         'ee79cae4dee4367a3ff900f584ee0c66'
         'e5a7ffe645a1eb032b8a13b7b1d7de93'
         '1caa78a56a1986fbf16cbe472422789b'
         'e6991329cde63c73979dc00aebdbad37'
         '002cbcd6491030248224d755da3a0a3b'
         'fd6c1ff09ed33e20fd40258d54fb360f'
         '58bdd7aa2a67a47ab3463673b2b5487f'
         'ea52842127746544a043eac5826d38ae'
         'dd74c2abbcf35c861bb0a62a1b8271d0'
         'b613db586808b4583c6ef1351089de49'
         'b57ed08c0f3f4324167e60f75e1acfce'
         '604186aa321eee826aa60b76f6aa2a80'
         '1f423bc9da76d8aead9b423443deb8a6'
         '6617d53a0519b8612cb11d02ceb7e4e3'
         '7ea9e7951eb1f338e43fc66bc8742f56'
         '440219c40d338febe0b4b3bdef3108c1'
         '561a96b6a386f373b5a99c8c72c5e408'
         '510abfb1e94113d05b66d0cba5d61efa'
         'f5768ce87b50541128943e5b86b829d2'
         '7a66fcd4e678359dd56320bb00ffc62e'
         'be0667010f62f71db32969ff94c5bfb7'
         '886e340eb3746a14dd8a57d73258c0a0'
         '0e0127bd0ab4d547a8c28480e519a175'
         '2b3f4464604f88c273d0dce0f5c589dc'
         'c5420e07f9d9f46d4ada2cc5a3d18d3b'
         '9e71c9bd1799a3bb5ce433d3e9e1fc00'
         'cc60a2c9f622264ae9cbb8c50e7c123a'
         'a35a1a27af395b4c26e82605cf91ab6b'
         '898bdc625e28f97ed93de01f218b3265'
         '6ebfc2ffd0ea3a316e062c294cd575f0'
         'f407a64581855476fe663d827eec35de'
         '04665e708a2f8b0b2d32b098169564e6'
         'd50cc90f4f9091a1a6a12476957c49bd'
         'e0d375049caf532c71b3790ed490f158'
         '21a16f240ba05ecb56f56223410ec96c'
         '59ec5302dd85b9bd4019c514c32a8d68'
         'c6d1308969318f4f63b3812956234397'
         '22f4baad605d44c35a1eeb1b6dbb9523'
         'c60ddb3e708473dee44128e0882a4678'
         'd8f496724830144da18d861f56ca8829'
         'e765f6cb9967efdf192b2defe2600e0a'
         '602bd33eb221abb6a980cdce1e75f2f5'
         '605a69057f29e456b15d55f3752de812')
