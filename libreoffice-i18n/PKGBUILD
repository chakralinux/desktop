pkgbase="libreoffice-i18n"

_rcver=6.1.3.2
pkgver=6.1.3
pkgrel=1
depends=("libreoffice-common>=$pkgver")

_oodlver=${pkgver}
#_oodlver=${_rcver}
_dirver=${_rcver}

arch=('x86_64')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
_url="http://download.documentfoundation.org/libreoffice/stable"

#_url+="/${pkgver}-rc2/rpm/x86-64"
_url+="/${pkgver}/rpm/$arch"
#_url+="/rpm/x86-64"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'fy            "Frisian"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'gug           "Guarani"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hsb           "Sorbian (Upper)"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kab           "Kabyle"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vec           "Venetian"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    echo ${_pkglang} " unpacking..."
    cd ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_${_pkglang}/RPMS

    # Remove dictionaries, which have duplicate files for different languages,
    # to be shipped separately.
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done
    
    # the helppack rpm goes also into the langpack dir - so far we don't want to split the helppacks separate
    rpmextract.sh ${srcdir}/LibreOffice_${_dirver}_Linux_x86-64_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice"
  provides=('libreoffice-langpack')

  cd "$srcdir"/LibreOffice_${_dirver}_Linux_x86-64_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}
  
for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86-64_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
md5sums=('efb96e7ec3880038e7f2f6cd783a0ea1'
         'dc174da52115418ceec2ea9025a0a8db'
         '77c97ab051faf6c8678dc0a3de5df0ef'
         '0f19f6a1bb03edea6c649074b31ad9f7'
         'cf9b770be2bf328c56718fb60c839b9b'
         '7ba54c641b3a227e7cf4855764da362d'
         'd0ecc0ee4de80749dce5da1a87573d52'
         '8af63070e2b57a2457d61825d6cff964'
         '4b41738d556fea14f149d50c552ac0c7'
         'cb950463855a12e076e5ff4564d49487'
         'bc92c221274120852c00d40b798d7d12'
         'ce3a027443aff54c00be55ef52eabaff'
         'e5d7f8ce81b050a70616d2d36c71b522'
         '644384168d771c8283ad50d4ac6ee8ac'
         '56dfdf31b4811ce9e57173e5b0e16c43'
         'e85601b379f3d4b40df42b1ea8f0c0d1'
         'b2c8084829ca3017c3bb03815bce7a94'
         'fda3dfa95dcbe572911a6c164c6c1271'
         '7b24ca12b3915e307f6dfee2c5f60d23'
         '8eca6e197c0dfa4fc74db0665d556f64'
         '47c40f1f5f66b28a13bc1fa685186bfc'
         '821ee15abed403e12bc79fb4f7dfdf5d'
         '95c2a9dc47deb5d20ad329b3c3489c55'
         '72e2a98749663f6778be594cd0a6b140'
         '4310ec64a6aea6dd97823db9e408fe02'
         '03a70da3b02268d96a9c2bf2b0f8087a'
         'a94e5f0b08f9fc51e89b9e8aa3082e4e'
         '8d1e049ffaaae052db3e1aaf6dc70d3d'
         '4db5ee5cf2330cc0730edf0f05607bc1'
         '625d22599df01e2c92893c729441e6a5'
         '22ab9e51cfa98569d39af2504b817057'
         '6c5d482e36bb70e0a800495e84296827'
         'cc1b197c1ac8850f6f064c68242baf6e'
         '2166f7ffa44a6ddb5e4e6c1d2141a3d0'
         '2c1cd6f69ab42235174c5ca621e2c7f2'
         '41f5f5471a4f7f8ec355d0469de05177'
         '896cc59cba568e2351ada6d619f62d97'
         '7a8d58fa9c5eb0f74ac3d0396306845c'
         '31cccd59e3beeb1e611a13fc8d887ee9'
         '11596a7bf49a54016ccc323c6376645e'
         'a9cfc3dde0c4158b54a46ada2bc1031d'
         'fcdb9119dcd33c8c4686aea575ee7538'
         'e854abeada43c9809830f30c305b9295'
         '7a332418843480f81ae0dab932d50180'
         '7f032c8cec3aa1458034362eeb29bcfb'
         '15ac4085589fce83e8cb9ed0d330c8dd'
         'afec878952167019530fe5789eee206e'
         '8778114419283373ac1e222cd169ec0b'
         'b97f6f668fcbf7308d874f704e48aafc'
         'f9e58b574ac4bb5200e8547f5f1e38b1'
         '938829e5302dfc34fc34fe773762e6f1'
         'd91ddc03a2b47308b89a0c8a742e896f'
         '7b7640edce8606f3430506dbe2428f4a'
         '1e67ec3f0f8b9f51bbdb4a66f3054a7c'
         'd235d97f18b2209819ed9b195751905c'
         'c465dd4f84d8f35be4dd5f259c5a978f'
         '7a8abe3ff4590bd4a2899beeecf40f08'
         '1d5c2c2c96887003f2bbeab13e8c15dd'
         '6c53295175359f46f6f68076b805079f'
         '5260a9904bf28c78ec7368a9204d7958'
         '58120a3f633a2facbcd6c0ebe7271bd8'
         'fdf16eb41281e878a73df0047e260496'
         '9f43a89954c9ef10019a7a439574fabf'
         '73dc278b69ffe275d6c4626bf1bf3a13'
         'edea19e4c52d1c6aed9c5a7f0ab2b732'
         'aa9604a9ba0481b911d6e369f9bbea01'
         'ed0211b07817ba43f5db77bbeef5141b'
         '3d867cff522926831fb16d46d379329c'
         '9ae6b8c1bffd1b5ad80b9a6507ef3710'
         'e7b4c359dcfb8e45b9bd0b475885bee9'
         '006094cb5a58cf7fc043253cd4f8c959'
         'c1694637e5234b990cba662598d2d73d'
         '6f142cc1736fbc23df3b4e93eeada643'
         '789e3db7be864688dc425703052b6a83'
         '96f0682c06f6a66a0eb1390d33c91121'
         '1ef18e7f645f00a58647d65f81110825'
         'ae21f75ee7b2da02b2ed78ff41ab18c9'
         '67aa7acf7ad5b5a01fb7486792652564'
         '7a924561924d6519a639e406e4a243fe'
         'b79781176f5cefb1fbcac6ee3ddbdf68'
         '78083d49036c241f9eef2a1f286ffe47'
         'e10ad0ff2e7fd2d63bc026bc2b9a8047'
         '09806755fa3ad10e1c639ff560a89c2c'
         '072610d74a3a878c7f6d51dd91adcbb0'
         'a3d1bdfc8412236ffccaba212b0dfb32'
         'ad914f39fdb1c284a9b0124e682233d4'
         'af0499411a73605a5b8716619dd5b468'
         '8be50c8a85fc7b2f6e6532a8acac49fe'
         '0e7b04b9d442661af0374b722442bc47'
         '599510ee616402d33fe824f749d5718b'
         '6f41b62a2575a75ec12a0a182c95766c'
         '9140723dccf6b83f772a78dd53557695'
         '6dd16e703c08ed770f76bf7cc99cb7ac'
         '286f03072936fac2e005c270b3355a1f'
         'e536aee7bc4125b1175026e98d4bd48f'
         '5a0228639d895b2b9fc8eeb0ca111e09'
         'acb7754ec9a17de0a085417915d9e80f'
         '0db02814f3db4c4fe7687f5d1726a8d6'
         '06dc6afc0e8c93fc2c6a3f395e853924'
         'dca14aca120a583cf9afd875cd515db6'
         '6dcc4095dd37c078170072cd099fba8f'
         '821828cf1b8737c819d6b5ea6503c0cc'
         '395644c2756f40f550f06f262488f6a6'
         'f16a6ab3702f4e6eee3b09a84ebb0c92'
         'c376d85b1be9e7d9b2d314b65201aad5'
         '4ffe09a2054d97f0d2f8851c8e117245'
         '06007a65812a6d82444e313800f32276'
         '79e99698b67a2fe8ca8ad59e3cb42e54'
         '4486bec27283c12d0dadbc0184a2e6ae'
         '69e16df52304e8aff770b28d334d45b4'
         '96822f872b940028ea02e3a7cf06aa98'
         '7a876750de8c145859e8dcc2089e5489'
         '9dda81b7004ec346c13578f00a761ab4'
         'cb31edc9039efb4906e94b0acdd6cd41'
         'd849a8fd636b49a46c6bbbd4e5d19395'
         '7069b09aa281a1e3dce93939c329378d'
         'e3aacb8f059bd9fc82f35117a2a9bfe2'
         '151291e27d0d43b9ccaa9096a05eb11c'
         '0481c91cede87f6a923ef3ce57e0e0b6'
         'c1415eea393f9e1128b1b97e35192f77'
         'e4edfd8c5635b6d0d8348cb299334dde'
         '707bd280e24c900612a37d8f638a96eb'
         '4ea3e7fd168344d9cc1025f3aa841c55'
         '1c1f78ef9de89a82d8cdeeedfc82f726'
         'd5aecc4c57771f01a95c6dceb43f7e7e'
         'ade75ef6b8646c89dd93445f6e56b1d2'
         '37443e6432fe7c4c7fe5a80bc83781ee'
         '80eb51c9abd1d94131644201dcab96ea'
         '009a7fab09d013179bc134c86377c28c'
         '1155e26ca2de43371d0f9436e913e758'
         '32d873e33ba05b0b1a9fb72d63b49fc5'
         'e6206c60bbb35645cc63c25c5bda7420'
         'eb9c1c8dcd5bc63f438301ab208cd484'
         '25b10064c91369397d3dd4628a4ec847'
         'd5df86a2a1ab6018eccd93ae68ef685d'
         'fcaaf276f9592c122d30a032f46fb3e1'
         '99aa181c277966945f0add4c6533da84'
         '2d3d3abc70932a6be88a543ebe029a4b'
         'e02f81e566a5c7b4d764df5d96a982b9'
         '697b74c58348ce0b80d9c57d4894a17d'
         'fcc46f49616fd0d06917106388175719'
         '437982dd394851718acc6853136e8bcd'
         '5c04f1b4ba64951fd89c1bb361f17575'
         'aa0b87c83904687a3a6bfaf7d406d912'
         'e60ce980c34ddacfdd1cf043e8a1c705'
         'c25efde652fc75e6788b3004784e1ecd'
         '61779ee7195428cc6a334288366d93dd'
         '9c7c404a4745b80dc23f6f57dd020d68'
         'f25b0af502809efe2205006716b3cf86'
         'a4eb32b7a2b70b454faf59b1bfd093c0'
         'e353289300b988a91014ff3ca8736593'
         '69c527d2946416aef81c4a95bf2623eb'
         '45a3a5842a087a9b4e197ff9077bbd0e'
         '05b1a23dedd7d9ab685244c7d993cc9a'
         '76084847be8c7e9f5599a3b65fb3a3e4'
         '6ece21876e2999b4ed086f9bc152c007'
         '2d53004cc2bde0b9f5255a7e3347ca07'
         '16847569438eb567acea090da1fbf41a'
         '6655555e53e9c8a573cf3c1256d773d8'
         '35341618d39cee66dff5a17bf6f4a644'
         'e518738df45678df5691ecc79182fb63'
         'aa35404a5495b2a31236defc289681ef'
         '99d4439d642a77e09ede6d2c9c6d022c'
         '3b6561dbeb672733c85205f7313becc1'
         '48207601b7efc874330d34f0773a0750'
         'cb701a9a1da9326531ee0595123e0ba3'
         'a044b4fefc0ac9e36bb729863e9fc3bb'
         '6f35b709e47a49087258398d3a208e6d'
         'b0ec0fd8c769bdbf8f6da93b990df4ed'
         'c7b1e64777666171f7d755e01db56ecd'
         'd5b5ab1f2917f4aa8ab1722122ad118c'
         '6955cf18a37fe2d298f29459c49815b5'
         '3f44a5023714c0c4b28f481c937438b6'
         'eb63651bc23f3157ffbeaec471116035'
         'df08de05c23e26b83f3ae0b059159173'
         '1009f86082c31655fe8b047090ccf849'
         '15264a64b9fa75deec03a1af1efc0dfb'
         '6765056044c7a2253144ad9ce662861f')
