#
# Chakra Packages for Chakra, part of chakra-project.org
#
# maintainer (i686): Phil Miller <philm[at]chakra-project[dog]org>
# maintainer (x86_64): Manuel Tortosa <manutortosa[at]chakra-project[dot]org>

pkgname=networkmanagement
pkgver=git20110126
pkgrel=1
pkgdesc="KDE4 Network Management and plasmoid"
arch=('i686' 'x86_64')
url="http://www.kde.org/"
license=('GPL')
depends=('kdebase-workspace' 'networkmanager')
makedepends=('cmake' 'python2' 'automoc4')
optdepends=('mobile-broadband-provider-info: allow to add new mobile connection')
provides=('knetworkmanagement')
conflicts=('networkmanager-plasmoid-svn' 'kdeplasma-applets-networkmanager')
replaces=('networkmanager-plasmoid-svn' 'kdeplasma-applets-networkmanager')
install=${pkgname}.install
#git clone git://anongit.kde.org/networkmanagement.git
source=("http://chakra-project.org/sources/networkmanagement/networkmanagement-${pkgver}.tar.xz")
md5sums=('f52a100b064527eca7b83086605dbee0')

build() {
  cd ${srcdir}
  	mkdir -p $srcdir/build
	cd $srcdir/build
	
	cmake ../networkmanagement -DCMAKE_INSTALL_PREFIX=${_installprefix} \
			  -DDBUS_SYSTEM_POLICY_DIR=/etc/dbus-1/system.d \
			  -DCMAKE_BUILD_TYPE=${_build_type} \
			  -DCMAKE_SKIP_RPATH=ON \
			  -DINSTALL_KNM_AUTOSTART=OFF \
			  -DCMAKE_{SHARED,MODULE,EXE}_LINKER_FLAGS='-Wl,--no-undefined -Wl,--as-needed'
	make || return 1
	
	make DESTDIR=${pkgdir} install || return 1
}
