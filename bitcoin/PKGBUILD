# Maintainer: UtG <utg.chakra.linux[at]gmail[dot]com>
# Contributor: Neophytos Kolokotronis <tetris4@gmail.com>
# Contributor: shahid <helllamer@gmail.com>


pkgname=bitcoin
pkgver=0.9.0
pkgrel=1
pkgdesc="Bitcoin is a peer-to-peer network based digital currency."
arch=('x86_64')
url="http://www.bitcoin.org/"
screenshot="http://c.fsdn.com/con/app/proj/bitcoin/screenshots/203604"
depends=('boost-libs' 'qt' 'miniupnpc' 'qrencode' 'db' 'protobuf')
makedepends=('boost' 'automoc4')
conflicts=('bitcoin-git')
replaces=('bitcoin-git')
license=('MIT')
source=("http://bitcoin.org/bin/$pkgver/bitcoin-$pkgver-linux.tar.gz"
	#https://raw.github.com/bitcoin/bitcoin/v$pkgver/contrib/debian/bitcoin-qt.desktop
	#https://raw.github.com/bitcoin/bitcoin/v$pkgver/share/pixmaps/bitcoin128.png
sha256sums=('0f767c13b2c670939750a26558cbb40a7f89ff5ba7d42ce63da0bcc0b701642d'
           # 'b65b377c0d9ecae9eea722843bca0add6bdb7e50929a7e1f751b79b6621c6073'
           # 'ad880c8459ecfdb96abe6a4689af06bdd27906e0edcd39d0915482f2da91e722')

            
prepare() {
  cd "$srcdir/$pkgbase-$pkgver-linux/src"
  tar xf $pkgbase-$pkgver.tar.gz
}
     
     
build() {
  cd "$srcdir/$pkgbase-$pkgver-linux/src/$pkgbase-$pkgver"
  ./configure --prefix=/usr --with-incompatible-bdb --with-gui=qt4
  qmake USE_QRCODE=1
  make
     
#build() {
#  cd ${pkgbase}-${pkgver}-linux/src

  # and make qt gui (USE_UPNP default activated)
#  qmake USE_QRCODE=1
#  make

  # make bitcoind
  make -f makefile.unix -C src  CXXFLAGS="$CXXFLAGS"
}

package() {
    cd "$srcdir/$pkgbase-$pkgver-linux/src/$pkgbase-$pkgver"
  
  # Install bitcoin-qt
  install -Dm755 bitcoin-qt "${pkgdir}"/usr/bin/bitcoin-qt
  install -Dm644 contrib/debian/bitcoin-qt.desktop \
    "${pkgdir}"/usr/share/applications/bitcoin.desktop
  install -Dm644 share/pixmaps/bitcoin128.png \
    "${pkgdir}"/usr/share/pixmaps/bitcoin128.png

  install -Dm644 COPYING "${pkgdir}/usr/share/licenses/${pkgname}/COPYING"

  # Install bitcoin deamon
  install -Dm755 src/bitcoind "${pkgdir}"/usr/bin/bitcoind
  install -Dm644 contrib/debian/examples/bitcoin.conf \
    "${pkgdir}/usr/share/doc/${pkgname}/examples/bitcoin.conf"
  install -Dm644 contrib/debian/manpages/bitcoind.1 \
    "${pkgdir}"/usr/share/man/man1/bitcoind.1
  install -Dm644 contrib/debian/manpages/bitcoin.conf.5 \
    "${pkgdir}"/usr/share/man/man5/bitcoin.conf.5
    
  install -Dm644 COPYING "${pkgdir}/usr/share/licenses/${pkgname}/COPYING"
}
