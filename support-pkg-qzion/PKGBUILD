#
# KDE SC Packages for Chakra, part of chakra-project.org
#
# maintainer (i686): Phil Miller <philm[at]chakra-project[dog]org>
# maintainer (x86_64): Manuel Tortosa <manutortosa[at]chakra-project[dot]org>

# include global config
source ../_buildscripts/${current_repo}-${_arch}-cfg.conf



# original name (used for the source and pkgnames)
_origname=qzion



pkgname=${_origname}
pkgver=0.4.0
pkgrel=4

pkgdesc="A canvas abstraction used by and made for QEdje."
url="http://dev.openbossa.org/trac/qedje"
license=('GPL')

source=(http://chakra-linux.org/sources/qzion/qzion-0.4.0.tar.gz
	http://chakra-linux.org/sources/qzion/qzion-0.4.0-gcc44.patch)
md5sums=(b9b61cf7dc6dc1720c5957cfa57c244a
	 5cbe03205622ee541e83085fc0584df1)

arch=('i686' 'x86_64')

depends=("${_qtpkg}>=${_qtver}" 'eet-svn' 'python' 'pyqt' 'sip')
options=('!splitdbg' '!splithdr')
makedepends=('gcc' 'make')

build()
{
	cd ${srcdir}/
	patch -Np0 -i ${srcdir}/qzion-0.4.0-gcc44.patch || return 1
	# Create the build directory
	mkdir -p ${_origname}-build
	cd ${_origname}-build

	cmake ../${_origname}-mainline -DCMAKE_BUILD_TYPE=${_build_type} \
			-DCMAKE_INSTALL_PREFIX=${_installprefix} \
			-DCMAKE_SKIP_RPATH=ON \
			-DCMAKE_{SHARED,MODULE,EXE}_LINKER_FLAGS='-Wl,--no-undefined -Wl,--as-needed'

	# workaround, fix build issue
	cp src/qzion.pc qzion.pc

	# Make and install the package
	make DESTDIR=${pkgdir} install || return 1
}
