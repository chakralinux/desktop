# Contributor: Arch Haskell Team <arch-haskell@haskell.org>
 
pkgname=cabal-install
pkgver=1.22.7.0
pkgrel=1
pkgdesc="The command-line interface for Cabal and Hackage."
url="http://hackage.haskell.org/package/cabal-install"
license=('custom:BSD3')
arch=('x86_64')
makedepends=('ghc' 'haskell-random' 'haskell-stm')
depends=('gmp' 'zlib')
source=("https://hackage.haskell.org/package/cabal-install-${pkgver}/cabal-install-${pkgver}.tar.gz")
sha512sums=('a88895ee38bf7451ba6a2e929ff224643ea0a536a9633d463d91a471e41b6aae302af2c3ca4fc914e4b3401fcadb137bb0c68c9fb7d0f768835374aef1b22766')
 
# the bootstrap script was broken on several releases
# build with a cabal sandbox to avoid unnecessary patching & headaches
build() {
  cd cabal-install-${pkgver}
 
  ./bootstrap.sh
}
 
package() {
  cd cabal-install-${pkgver}
 
  install -d ${pkgdir}/usr/bin
  install -m755 dist/build/cabal/cabal \
    ${pkgdir}/usr/bin
 
 
  install -d ${pkgdir}/usr/share/licenses/${pkgname}
  install -m644 LICENSE \
    ${pkgdir}/usr/share/licenses/${pkgname}
 
  # add bash completion
  install -d ${pkgdir}/usr/share/bash-completion/completions
  install -m644 bash-completion/cabal \
    ${pkgdir}/usr/share/bash-completion/completions
}